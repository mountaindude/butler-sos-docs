<!doctype html>
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Hugo 0.58.2" />

<META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">

<link rel="alternate" type="application/rss&#43;xml" href="https://butler-sos.ptarmiganlabs.com/docs/getting_started/install_config/docker/index.xml">


<link rel="shortcut icon" href="/favicons/favicon.ico" >
<link rel="apple-touch-icon" href="/favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="/favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/favicons/android-36x36.png" sizes="36x36">
<link rel="icon" type="image/png" href="/favicons/android-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="/favicons/android-72x72.png" sizes="72x72">
<link rel="icon" type="image/png" href="/favicons/android-96x196.png" sizes="96x196">
<link rel="icon" type="image/png" href="/favicons/android-144x144.png" sizes="144x144">
<link rel="icon" type="image/png" href="/favicons/android-192x192.png"sizes="192x192">

<title>Docker | Butler SOS</title><meta property="og:title" content="Docker" />
<meta property="og:description" content="Running Butler SOS in Docker. Installation and configuration.
" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://butler-sos.ptarmiganlabs.com/docs/getting_started/install_config/docker/" />
<meta property="og:site_name" content="Butler SOS" />
<meta itemprop="name" content="Docker">
<meta itemprop="description" content="Running Butler SOS in Docker. Installation and configuration.
">

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Docker"/>
<meta name="twitter:description" content="Running Butler SOS in Docker. Installation and configuration.
"/>





<link rel="preload" href="/scss/main.min.9aeffc9e83359f1f6c567fea8e2076603d4e37a6b64417981024b11fe9769455.css" as="style">
<link href="/scss/main.min.9aeffc9e83359f1f6c567fea8e2076603d4e37a6b64417981024b11fe9769455.css" rel="stylesheet" integrity="">

<script
  src="https://code.jquery.com/jquery-3.3.1.min.js"
  integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
  crossorigin="anonymous"></script>


    <title>Docker | Butler SOS</title>
  </head>
  <body class="td-section">
    <header>
      
<nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar">
        <a class="navbar-brand" href="/">
		<span class="navbar-logo"></span><span class="text-uppercase font-weight-bold">Butler SOS</span>
	</a>
	<div class="td-navbar-nav-scroll ml-md-auto" id="main_navbar">
		<ul class="navbar-nav mt-2 mt-lg-0">
			
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				<a class="nav-link" href="/about/" ><span>About</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				<a class="nav-link active" href="/docs/" ><span class="active">Documentation</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				<a class="nav-link" href="/blog/" ><span>Blog</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				<a class="nav-link" href="/community/" ><span>Community</span></a>
			</li>
			
			
			
		</ul>
	</div>
	<div class="navbar-nav d-none d-lg-block"></div>
</nav>

    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <div class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none">
            




<div id="td-sidebar-menu" class="td-sidebar__inner">
  
  <form class="td-sidebar__search d-flex align-items-center">
    
    <button class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" type="button" data-toggle="collapse" data-target="#td-section-nav" aria-controls="td-docs-nav" aria-expanded="false" aria-label="Toggle section navigation">
    </button>
  </form>
  
  <nav class="collapse td-sidebar-nav pt-2 pl-4" id="td-section-nav">
    
    






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/docs/" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section">Documentation</a>
  </li>
  <ul>
    <li class="collapse show" id="docs">
      
      
      
      
      






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/docs/overview/" class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Overview</a>
  </li>
  <ul>
    <li class="collapse " id="docs-overview">
      
      
      
    </li>
  </ul>
</ul>

      
      
      
      






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/docs/getting_started/" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section">Getting started</a>
  </li>
  <ul>
    <li class="collapse show" id="docs-getting-started">
      
      
      
      
      






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/docs/getting_started/choose_platform/" class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Choose a platform</a>
  </li>
  <ul>
    <li class="collapse " id="docs-getting-started-choose-platform">
      
      
      
    </li>
  </ul>
</ul>

      
      
      
      






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/docs/getting_started/install_config/" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section">Install &amp; Configure</a>
  </li>
  <ul>
    <li class="collapse show" id="docs-getting-started-install-config">
      
      
      
      
      






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/docs/getting_started/install_config/sense_certificates/" class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Get certificates</a>
  </li>
  <ul>
    <li class="collapse " id="docs-getting-started-install-config-sense-certificates">
      
      
      
    </li>
  </ul>
</ul>

      
      
      
      






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/docs/getting_started/install_config/config_file_format/" class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Config file format</a>
  </li>
  <ul>
    <li class="collapse " id="docs-getting-started-install-config-config-file-format">
      
      
      
    </li>
  </ul>
</ul>

      
      
      
      






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/docs/getting_started/install_config/docker/" class="align-left pl-0 pr-2 active td-sidebar-link td-sidebar-link__section">Docker</a>
  </li>
  <ul>
    <li class="collapse show" id="docs-getting-started-install-config-docker">
      
      
      
    </li>
  </ul>
</ul>

      
      
      
      






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/docs/getting_started/install_config/windows/" class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Windows</a>
  </li>
  <ul>
    <li class="collapse " id="docs-getting-started-install-config-windows">
      
      
      
    </li>
  </ul>
</ul>

      
      
      
      






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/docs/getting_started/install_config/linux_macos/" class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Linux, Mac OS</a>
  </li>
  <ul>
    <li class="collapse " id="docs-getting-started-install-config-linux-macos">
      
      
      
    </li>
  </ul>
</ul>

      
      
      
      






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/docs/getting_started/install_config/influxdb_grafana/" class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">InfluxDB &amp; Grafana</a>
  </li>
  <ul>
    <li class="collapse " id="docs-getting-started-install-config-influxdb-grafana">
      
      
      
    </li>
  </ul>
</ul>

      
      
    </li>
  </ul>
</ul>

      
      
      
      






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/docs/getting_started/influxdb_data_structure/" class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Available metrics</a>
  </li>
  <ul>
    <li class="collapse " id="docs-getting-started-influxdb-data-structure">
      
      
      
    </li>
  </ul>
</ul>

      
      
    </li>
  </ul>
</ul>

      
      
      
      






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/docs/examples/" class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Examples</a>
  </li>
  <ul>
    <li class="collapse " id="docs-examples">
      
      
      
      
      






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/docs/examples/general_sense_monitoring/" class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">General monitoring</a>
  </li>
  <ul>
    <li class="collapse " id="docs-examples-general-sense-monitoring">
      
      
      
    </li>
  </ul>
</ul>

      
      
    </li>
  </ul>
</ul>

      
      
      
      






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/docs/reference/" class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Reference</a>
  </li>
  <ul>
    <li class="collapse " id="docs-reference">
      
      
      
    </li>
  </ul>
</ul>

      
      
      
      






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/docs/version_history/" class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Version history</a>
  </li>
  <ul>
    <li class="collapse " id="docs-version-history">
      
      
      
    </li>
  </ul>
</ul>

      
      
      
      






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/docs/contribution-guidelines/" class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Contribution guidelines</a>
  </li>
  <ul>
    <li class="collapse " id="docs-contribution-guidelines">
      
      
      
    </li>
  </ul>
</ul>

      
      
    </li>
  </ul>
</ul>

  </nav>
</div>




          </div>
          <div class="d-none d-xl-block col-xl-2 td-toc d-print-none">
            




<div class="td-page-meta ml-2 pb-1 pt-2 mb-0">





<a href="https://github.com/ptarmiganlabs/butler-sos-docs/edit/master/content/en/docs/getting_started/install_config/docker/_index.md" target="_blank"><i class="fa fa-edit fa-fw"></i> Edit this page</a>
<a href="https://github.com/ptarmiganlabs/butler-sos-docs/issues/new?title=Docker" target="_blank"><i class="fab fa-github fa-fw"></i> Create documentation issue</a>


<a href="https://github.com/ptarmiganlabs/butler-sos/issues/new" target="_blank"><i class="fas fa-tasks fa-fw"></i> Create project issue</a>

</div>






<nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#installation">Installation</a>
<ul>
<li><a href="#docker-runtime">Docker runtime</a></li>
<li><a href="#butler-sos-installation-and-configuration">Butler SOS installation and configuration</a></li>
<li><a href="#install-configure-walkthrough">Install &amp; configure - walkthrough</a></li>
</ul></li>
</ul></li>
</ul>
</nav>



          </div>
          <main class="col-12 col-md-9 col-xl-8 pl-md-5" role="main">
            <nav aria-label="breadcrumb" class="d-none d-md-block d-print-none">
	<ol class="breadcrumb spb-1">
		













<li class="breadcrumb-item" >
	<a href="https://butler-sos.ptarmiganlabs.com/docs/">Documentation</a>
</li>




<li class="breadcrumb-item" >
	<a href="https://butler-sos.ptarmiganlabs.com/docs/getting_started/">Getting started</a>
</li>




<li class="breadcrumb-item" >
	<a href="https://butler-sos.ptarmiganlabs.com/docs/getting_started/install_config/">Install &amp; Configure</a>
</li>




<li class="breadcrumb-item active" aria-current="page">
	<a href="https://butler-sos.ptarmiganlabs.com/docs/getting_started/install_config/docker/">Docker</a>
</li>

	</ol>
</nav	>

            
<div class="td-content">
	<h1>Docker</h1>
	<div class="lead">Running Butler SOS in Docker. Installation and configuration.</div>
	

<p>Docker is great in that it runs on many different platforms.
This means that as long as the Docker runtime environment is installed, you can run Butler SOS on your Mac laptop, on a Linux server or on a Windows server.</p>

<h2 id="installation">Installation</h2>

<h3 id="docker-runtime">Docker runtime</h3>

<p>Installing Docker is beyond the scope of this document, but there are plenty of online tutorials covering this.</p>

<h3 id="butler-sos-installation-and-configuration">Butler SOS installation and configuration</h3>

<p>When using Docker there is no installation in the traditional sense.<br />
Instead we (in this case) use a docker-compose file to define how Butler SOS should be executed within a Docker container.</p>

<p>Configuration of Butler specific settings is then done using a YAML file.</p>

<h3 id="install-configure-walkthrough">Install &amp; configure - walkthrough</h3>

<p>Create a directory for Butler SOS. Config files and logs will be stored here.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">proton:code goran$ mkdir -p butler-sos-docker/config/certificate
proton:code goran$ mkdir -p butler-sos-docker/logs
proton:code goran$ <span style="color:#204a87">cd</span> butler-sos-docker
proton:butler-sos-docker goran$</code></pre></div>
<ol>
<li><p>Copy <a href="https://github.com/ptarmiganlabs/butler-sos/blob/master/src/docker-compose.yml" target="_blank">docker-compose.yml</a> from the GitHub repository to the main Butler SOS directory. The directory where the docker-compose file is stored is the &lsquo;root&rsquo; directory of Butler SOS - everything else is relative to this directory.</p></li>

<li><p>Adapt the docker-compose file as needed (usually no changes are needed if you want to run the latest version of Butler SOS).</p></li>

<li><p>Copy the <a href="https://github.com/ptarmiganlabs/butler-sos/blob/master/src/config/production_template.yaml" target="_blank">YAML config file</a> from the GitHub repository into the ./config directory, rename it to <code>production.yaml</code> (or something else, as long as it matches the NODE_ENV environment variable) and edit it as needed. Note that for the Docker setup the path to certificates (as specified in the YAML config file) should be <code>/nodeapp/config/certificate/</code> (this is the Docker container&rsquo;s internal path to the certificate directory).</p></li>

<li><p>Edit the config file above as needed, with respect to your local Sense environment, folder paths etc. The provided template file has reasonable defualt settings where possible, but there are also a number of paths, passwords etc that must be configured.</p></li>

<li><p>Export certifiates from the QMC in Qlik Sense Enterprise, place them in the <code>./config/certificate</code> directory (i.e. in a subdirectory to the directory where the docker-comspose file is stored). The certificates can in theory be placed anywhere, as long as they are made available to the Docker container via a volume mount in the docker-compose.yaml file (e.g. <code>- &quot;./config:/nodeapp/config&quot;</code>).</p></li>
</ol>

<p>Let&rsquo;s do this one step at a time.<br />
What files are there?</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">proton:butler-sos-docker goran$ ls -la
total <span style="color:#0000cf;font-weight:bold">8</span>
drwxr-xr-x   <span style="color:#0000cf;font-weight:bold">4</span> goran  staff   <span style="color:#0000cf;font-weight:bold">128</span> Oct <span style="color:#0000cf;font-weight:bold">14</span> <span style="color:#0000cf;font-weight:bold">17</span>:10 .
drwxr-xr-x  <span style="color:#0000cf;font-weight:bold">51</span> goran  staff  <span style="color:#0000cf;font-weight:bold">1632</span> Oct <span style="color:#0000cf;font-weight:bold">14</span> <span style="color:#0000cf;font-weight:bold">17</span>:08 ..
drwxr-xr-x   <span style="color:#0000cf;font-weight:bold">3</span> goran  staff    <span style="color:#0000cf;font-weight:bold">96</span> Oct <span style="color:#0000cf;font-weight:bold">14</span> <span style="color:#0000cf;font-weight:bold">17</span>:08 config
-rw-r--r--@  <span style="color:#0000cf;font-weight:bold">1</span> goran  staff   <span style="color:#0000cf;font-weight:bold">357</span> Oct <span style="color:#0000cf;font-weight:bold">14</span> <span style="color:#0000cf;font-weight:bold">17</span>:10 docker-compose.yml
proton:butler-sos-docker goran$
proton:butler-sos-docker goran$ ls -la config/
total <span style="color:#0000cf;font-weight:bold">8</span>
drwxr-xr-x  <span style="color:#0000cf;font-weight:bold">4</span> goran  staff   <span style="color:#0000cf;font-weight:bold">128</span> Oct <span style="color:#0000cf;font-weight:bold">14</span> <span style="color:#0000cf;font-weight:bold">17</span>:11 .
drwxr-xr-x  <span style="color:#0000cf;font-weight:bold">4</span> goran  staff   <span style="color:#0000cf;font-weight:bold">128</span> Oct <span style="color:#0000cf;font-weight:bold">14</span> <span style="color:#0000cf;font-weight:bold">17</span>:10 ..
drwxr-xr-x  <span style="color:#0000cf;font-weight:bold">2</span> goran  staff    <span style="color:#0000cf;font-weight:bold">64</span> Oct <span style="color:#0000cf;font-weight:bold">14</span> <span style="color:#0000cf;font-weight:bold">17</span>:08 certificate
-rw-r--r--@ <span style="color:#0000cf;font-weight:bold">1</span> goran  staff  <span style="color:#0000cf;font-weight:bold">1335</span> Oct <span style="color:#0000cf;font-weight:bold">14</span> <span style="color:#0000cf;font-weight:bold">17</span>:11 production.yaml
proton:butler-sos-docker goran$
proton:butler-sos-docker goran$ ls -la config/certificate/
total <span style="color:#0000cf;font-weight:bold">24</span>
drwxr-xr-x  <span style="color:#0000cf;font-weight:bold">5</span> goran  staff   <span style="color:#0000cf;font-weight:bold">160</span> Oct <span style="color:#0000cf;font-weight:bold">14</span> <span style="color:#0000cf;font-weight:bold">17</span>:13 .
drwxr-xr-x  <span style="color:#0000cf;font-weight:bold">4</span> goran  staff   <span style="color:#0000cf;font-weight:bold">128</span> Oct <span style="color:#0000cf;font-weight:bold">14</span> <span style="color:#0000cf;font-weight:bold">17</span>:11 ..
-rw-r--r--@ <span style="color:#0000cf;font-weight:bold">1</span> goran  staff  <span style="color:#0000cf;font-weight:bold">1166</span> Oct <span style="color:#0000cf;font-weight:bold">14</span> <span style="color:#0000cf;font-weight:bold">17</span>:13 client.pem
-rw-r--r--@ <span style="color:#0000cf;font-weight:bold">1</span> goran  staff  <span style="color:#0000cf;font-weight:bold">1702</span> Oct <span style="color:#0000cf;font-weight:bold">14</span> <span style="color:#0000cf;font-weight:bold">17</span>:13 client_key.pem
-rw-r--r--@ <span style="color:#0000cf;font-weight:bold">1</span> goran  staff  <span style="color:#0000cf;font-weight:bold">1192</span> Oct <span style="color:#0000cf;font-weight:bold">14</span> <span style="color:#0000cf;font-weight:bold">17</span>:13 root.pem
proton:butler-sos-docker goran$</code></pre></div>
<p>What does the config file look like?</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">proton:butler-sos-docker goran$ cat config/production.yaml
Butler-SOS:
  <span style="color:#8f5902;font-style:italic"># All configuration items are mandatory, unless otherwise noted.</span>

  <span style="color:#8f5902;font-style:italic"># Logging configuration</span>
  logLevel: info          <span style="color:#8f5902;font-style:italic"># Log level. Possible log levels are silly, debug, verbose, info, warn, error</span>
  fileLogging: <span style="color:#204a87">true</span>       <span style="color:#8f5902;font-style:italic"># true/false to enable/disable logging to disk file</span>
  logDirectory: logs      <span style="color:#8f5902;font-style:italic"># Subdirectory where log files are stored</span>

  <span style="color:#8f5902;font-style:italic"># Qlik Sense logging db config parameters</span>
  logdb:
    enableLogDb: <span style="color:#204a87">true</span>
    <span style="color:#8f5902;font-style:italic"># Items below are mandatory if enableLogDb=true</span>
    pollingInterval: <span style="color:#0000cf;font-weight:bold">60000</span>    <span style="color:#8f5902;font-style:italic"># How often (milliseconds) should Postgres log db be queried for warnings and errors?</span>
    queryPeriod: <span style="color:#0000cf;font-weight:bold">5</span> minutes    <span style="color:#8f5902;font-style:italic"># How far back should Butler SOS query for log entries? Default is 5 min</span>
    host: &lt;IP or FQDN of Qlik Sense logging db&gt;
    port: <span style="color:#0000cf;font-weight:bold">4432</span>
    qlogsReaderUser: qlogs_reader
    qlogsReaderPwd: &lt;pwd&gt;
    extractErrors: <span style="color:#204a87">true</span>       <span style="color:#8f5902;font-style:italic"># Should error level entries be extracted from log db into Influxdb?</span>
    extractWarnings: <span style="color:#204a87">true</span>     <span style="color:#8f5902;font-style:italic"># Should warn level entries be extracted from log db into Influxdb?</span>
    extractInfo: <span style="color:#204a87">true</span>         <span style="color:#8f5902;font-style:italic"># Should info level entries be extracted from log db into Influxdb? Warning! Seting this to true will result in LOTS of log messages being retrrieved by Butler SOS!</span>

  <span style="color:#8f5902;font-style:italic"># Certificates to use when querying Sense for healthcheck data. Get these from the Certificate Export in QMC.</span>
  cert:
    <span style="color:#8f5902;font-style:italic"># If running Butler SOS in a Docker container, the cert paths MUST be the following</span>
    clientCert: /nodeapp/config/certificate/client.pem
    clientCertKey: /nodeapp/config/certificate/client_key.pem
    clientCertCA: /nodeapp/config/certificate/root.pem

  <span style="color:#8f5902;font-style:italic"># MQTT config parameters</span>
  mqttConfig:
    enableMQTT: <span style="color:#204a87">false</span>
    <span style="color:#8f5902;font-style:italic"># Items below are mandatory if enableMQTT=true</span>
    brokerHost: &lt;IP of MQTT server&gt;
    brokerPort: <span style="color:#0000cf;font-weight:bold">1883</span>
    baseTopic: butler-sos/          <span style="color:#8f5902;font-style:italic"># Topic should end with /</span>

  <span style="color:#8f5902;font-style:italic"># Influx db config parameters</span>
  influxdbConfig:
    enableInfluxdb: <span style="color:#204a87">true</span>
    <span style="color:#8f5902;font-style:italic"># Items below are mandatory if enableInfluxdb=true</span>
    hostIP: &lt;IP or FQDN of Influxdb server&gt;
    hostPort: &lt;Port where Influxdb is listening&gt;    <span style="color:#8f5902;font-style:italic"># Optional. Default value=8086</span>
    auth:
      enable: <span style="color:#204a87">false</span>                 <span style="color:#8f5902;font-style:italic"># Does influxdb instance require authentication (true/false)?</span>
      username: &lt;username&gt;          <span style="color:#8f5902;font-style:italic"># Username for Influxdb authentication. Mandatory if auth.enable=true</span>
      password: &lt;password&gt;          <span style="color:#8f5902;font-style:italic"># Password for Influxdb authentication. Mandatory if auth.enable=true</span>
    dbName: SenseOps
    <span style="color:#8f5902;font-style:italic"># Default retention policy that should be created in InfluxDB when Butler SOS creates a new database there.</span> 
    <span style="color:#8f5902;font-style:italic"># Any data older than retention policy threshold will be purged from InfluxDB.</span>
    retentionPolicy:
      name: 4weeks
      duration: 4w
    <span style="color:#8f5902;font-style:italic"># Control whether certain fields are stored in InfluxDB or not</span>
    <span style="color:#8f5902;font-style:italic"># Use with caution! Enabling activeDocs, loadedDocs or inMemoryDocs may result in lots of data sent to InfluxDB.</span>
    includeFields:
      activeDocs: <span style="color:#204a87">false</span>              <span style="color:#8f5902;font-style:italic"># Should data on what docs are active be stored in Influxdb (true/false)?</span> 
      loadedDocs: <span style="color:#204a87">false</span>              <span style="color:#8f5902;font-style:italic"># Should data on what docs are loaded be stored in Influxdb (true/false)?</span>
      inMemoryDocs: <span style="color:#204a87">false</span>            <span style="color:#8f5902;font-style:italic"># Should data on what docs are in memory be stored in Influxdb (true/false)?</span>

  <span style="color:#8f5902;font-style:italic"># Sessions per virtual proxy</span>
  userSessions:
    enableSessionExtract: <span style="color:#204a87">true</span>    <span style="color:#8f5902;font-style:italic"># Query unique user IDs of what users have sessions open (true/false)?</span>
    <span style="color:#8f5902;font-style:italic"># Items below are mandatory if enableSessionExtract=true</span>    
    pollingInterval: <span style="color:#0000cf;font-weight:bold">15000</span>        <span style="color:#8f5902;font-style:italic"># How often (milliseconds) should detailed session data be polled?</span>

  serversToMonitor:
    pollingInterval: <span style="color:#0000cf;font-weight:bold">30000</span>        <span style="color:#8f5902;font-style:italic"># How often (milliseconds) should the healthcheck API be polled?</span>

    <span style="color:#8f5902;font-style:italic"># List of extra tags for each server. Useful for creating more advanced Grafana dashboards.</span>
    <span style="color:#8f5902;font-style:italic"># Each server below MUST include these tags in its serverTags property.</span>
    <span style="color:#8f5902;font-style:italic"># The tags below are just examples - define your own as needed</span>
    serverTagsDefinition: 
      - server_group
      - serverLocation
      - server-type
      - serverBrand

    <span style="color:#8f5902;font-style:italic"># Sense Servers that should be queried for healthcheck data</span> 
    servers:
      - host: &lt;server1.my.domain&gt;:4747
        serverName: &lt;server1&gt;
        serverDescription: &lt;description&gt;
        logDbHost: &lt;host name as used in QLogs db&gt;
        userSessions:
          enable: <span style="color:#204a87">true</span>
          <span style="color:#8f5902;font-style:italic"># Items below are mandatory if userSessions.enable=true</span>
          host: &lt;server1.my.domain&gt;:4243
          virtualProxies:
            - virtualProxy: /                 <span style="color:#8f5902;font-style:italic"># Default virtual proxy</span>
            - virtualProxy: /hdr              <span style="color:#8f5902;font-style:italic"># &#34;hdr&#34; virtual proxy</span>
        serverTags:
          server_group: DEV
          serverLocation: Asia
          server-type: virtual
          serverBrand: Dell
      - host: &lt;server2.my.domain&gt;:4747
        serverName: &lt;server2&gt;
        serverDescription: &lt;description&gt;
        logDbHost: &lt;host name as used in QLogs db&gt;
        userSessions:
          enable: <span style="color:#204a87">true</span>
          <span style="color:#8f5902;font-style:italic"># Items below are mandatory if userSessions.enable=true</span>
          host: &lt;server2.my.domain&gt;:4243
          virtualProxies:
            - virtualProxy: /finance          <span style="color:#8f5902;font-style:italic"># &#34;finance&#34; virtual proxy</span>
        serverTags:
          server_group: PROD
          serverLocation: Europe
          server-type: physical
          serverBrand: HP
  
proton:butler-sos-docker goran$</code></pre></div>
<p>What does the docker-compose.yml file look like?</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">proton:butler-sos-docker goran$ cat docker-compose.yml
<span style="color:#8f5902;font-style:italic"># docker-compose.yml</span>
version: <span style="color:#4e9a06">&#39;3.3&#39;</span>
services:
  butler-sos:
    image: ptarmiganlabs/butler-sos:5.0.0
    container_name: butler-sos
    restart: always
    volumes:
      <span style="color:#8f5902;font-style:italic"># Make config file accessible outside of container</span>
      - <span style="color:#4e9a06">&#34;./config:/nodeapp/config&#34;</span>
      - <span style="color:#4e9a06">&#34;./logs:/nodeapp/logs&#34;</span>
    environment:
      - <span style="color:#4e9a06">&#34;NODE_ENV=production&#34;</span>         <span style="color:#8f5902;font-style:italic"># Means that Butler SOS will read config data from production.yaml</span> 
    logging:
      driver: <span style="color:#4e9a06">&#34;json-file&#34;</span>
      options:
        max-file: <span style="color:#4e9a06">&#34;5&#34;</span>
        max-size: <span style="color:#4e9a06">&#34;5m&#34;</span>
proton:butler-sos-docker goran$</code></pre></div>
<p>Ok, all good. Let&rsquo;s start Butler SOS using docker-compose:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">proton:butler-sos-docker goran$ docker-compose up
➜ docker-compose up
Creating butler-sos ... <span style="color:#204a87;font-weight:bold">done</span>
Attaching to butler-sos
butler-sos    <span style="color:#000;font-weight:bold">|</span> <span style="color:#0000cf;font-weight:bold">2019</span>-10-12T20:14:21.814Z debug: CONFIG: Setting up new Influx database: Found server tag : server_group
butler-sos    <span style="color:#000;font-weight:bold">|</span> <span style="color:#0000cf;font-weight:bold">2019</span>-10-12T20:14:21.824Z debug: CONFIG: Setting up new Influx database: Found server tag : serverLocation
butler-sos    <span style="color:#000;font-weight:bold">|</span> <span style="color:#0000cf;font-weight:bold">2019</span>-10-12T20:14:21.826Z debug: CONFIG: Setting up new Influx database: Found server tag : server-type
butler-sos    <span style="color:#000;font-weight:bold">|</span> <span style="color:#0000cf;font-weight:bold">2019</span>-10-12T20:14:21.829Z debug: CONFIG: Setting up new Influx database: Found server tag : serverBrand
butler-sos    <span style="color:#000;font-weight:bold">|</span> <span style="color:#0000cf;font-weight:bold">2019</span>-10-12T20:14:21.831Z info: CONFIG: Influxdb enabled: <span style="color:#204a87">true</span>
butler-sos    <span style="color:#000;font-weight:bold">|</span> <span style="color:#0000cf;font-weight:bold">2019</span>-10-12T20:14:21.832Z info: CONFIG: Influxdb host IP: <span style="color:#0000cf;font-weight:bold">192</span>.168.100.20
butler-sos    <span style="color:#000;font-weight:bold">|</span> <span style="color:#0000cf;font-weight:bold">2019</span>-10-12T20:14:21.833Z info: CONFIG: Influxdb host port: <span style="color:#0000cf;font-weight:bold">8086</span>
butler-sos    <span style="color:#000;font-weight:bold">|</span> <span style="color:#0000cf;font-weight:bold">2019</span>-10-12T20:14:21.834Z info: CONFIG: Influxdb db name: SenseOps
butler-sos    <span style="color:#000;font-weight:bold">|</span> <span style="color:#0000cf;font-weight:bold">2019</span>-10-12T20:14:22.006Z info: --------------------------------------
butler-sos    <span style="color:#000;font-weight:bold">|</span> <span style="color:#0000cf;font-weight:bold">2019</span>-10-12T20:14:22.006Z info: Starting Butler SOS
butler-sos    <span style="color:#000;font-weight:bold">|</span> <span style="color:#0000cf;font-weight:bold">2019</span>-10-12T20:14:22.009Z info: Log level is: debug
butler-sos    <span style="color:#000;font-weight:bold">|</span> <span style="color:#0000cf;font-weight:bold">2019</span>-10-12T20:14:22.010Z info: App version is: <span style="color:#0000cf;font-weight:bold">5</span>.0.0
butler-sos    <span style="color:#000;font-weight:bold">|</span> <span style="color:#0000cf;font-weight:bold">2019</span>-10-12T20:14:22.011Z info: --------------------------------------
butler-sos    <span style="color:#000;font-weight:bold">|</span> <span style="color:#0000cf;font-weight:bold">2019</span>-10-12T20:14:22.012Z debug: Client cert: /nodeapp/config/certificate/client.pem
butler-sos    <span style="color:#000;font-weight:bold">|</span> <span style="color:#0000cf;font-weight:bold">2019</span>-10-12T20:14:22.013Z debug: Client cert key: /nodeapp/config/certificate/client_key.pem
butler-sos    <span style="color:#000;font-weight:bold">|</span> <span style="color:#0000cf;font-weight:bold">2019</span>-10-12T20:14:22.014Z debug: CA cert: /nodeapp/config/certificate/root.pem
butler-sos    <span style="color:#000;font-weight:bold">|</span> <span style="color:#0000cf;font-weight:bold">2019</span>-10-12T20:14:22.018Z debug: USER SESSIONS: Monitor user sessions <span style="color:#204a87;font-weight:bold">for</span> these servers/virtual proxies: <span style="color:#ce5c00;font-weight:bold">[</span>
butler-sos    <span style="color:#000;font-weight:bold">|</span>   <span style="color:#ce5c00;font-weight:bold">{</span>
butler-sos    <span style="color:#000;font-weight:bold">|</span>     <span style="color:#4e9a06">&#34;host&#34;</span>: <span style="color:#4e9a06">&#34;pro2-win1.ptarmiganlabs.net:4747&#34;</span>,
butler-sos    <span style="color:#000;font-weight:bold">|</span>     <span style="color:#4e9a06">&#34;serverName&#34;</span>: <span style="color:#4e9a06">&#34;sense1&#34;</span>,
butler-sos    <span style="color:#000;font-weight:bold">|</span>     <span style="color:#4e9a06">&#34;serverDescription&#34;</span>: <span style="color:#4e9a06">&#34;Central&#34;</span>,
butler-sos    <span style="color:#000;font-weight:bold">|</span>     <span style="color:#4e9a06">&#34;logDbHost&#34;</span>: <span style="color:#4e9a06">&#34;pro2-win1&#34;</span>,
butler-sos    <span style="color:#000;font-weight:bold">|</span>     <span style="color:#4e9a06">&#34;userSessions&#34;</span>: <span style="color:#ce5c00;font-weight:bold">{</span>
butler-sos    <span style="color:#000;font-weight:bold">|</span>       <span style="color:#4e9a06">&#34;enable&#34;</span>: true,
butler-sos    <span style="color:#000;font-weight:bold">|</span>       <span style="color:#4e9a06">&#34;host&#34;</span>: <span style="color:#4e9a06">&#34;pro2-win1.ptarmiganlabs.net:4243&#34;</span>,
butler-sos    <span style="color:#000;font-weight:bold">|</span>       <span style="color:#4e9a06">&#34;virtualProxies&#34;</span>: <span style="color:#ce5c00;font-weight:bold">[</span>
butler-sos    <span style="color:#000;font-weight:bold">|</span>         <span style="color:#ce5c00;font-weight:bold">{</span>
butler-sos    <span style="color:#000;font-weight:bold">|</span>           <span style="color:#4e9a06">&#34;virtualProxy&#34;</span>: <span style="color:#4e9a06">&#34;/&#34;</span>
butler-sos    <span style="color:#000;font-weight:bold">|</span>         <span style="color:#ce5c00;font-weight:bold">}</span>,
butler-sos    <span style="color:#000;font-weight:bold">|</span>         <span style="color:#ce5c00;font-weight:bold">{</span>
butler-sos    <span style="color:#000;font-weight:bold">|</span>           <span style="color:#4e9a06">&#34;virtualProxy&#34;</span>: <span style="color:#4e9a06">&#34;/hdr&#34;</span>
butler-sos    <span style="color:#000;font-weight:bold">|</span>         <span style="color:#ce5c00;font-weight:bold">}</span>
butler-sos    <span style="color:#000;font-weight:bold">|</span>       <span style="color:#ce5c00;font-weight:bold">]</span>
butler-sos    <span style="color:#000;font-weight:bold">|</span>     <span style="color:#ce5c00;font-weight:bold">}</span>,
butler-sos    <span style="color:#000;font-weight:bold">|</span>     <span style="color:#4e9a06">&#34;serverTags&#34;</span>: <span style="color:#ce5c00;font-weight:bold">{</span>
butler-sos    <span style="color:#000;font-weight:bold">|</span>       <span style="color:#4e9a06">&#34;server_group&#34;</span>: <span style="color:#4e9a06">&#34;CENTRAL&#34;</span>,
butler-sos    <span style="color:#000;font-weight:bold">|</span>       <span style="color:#4e9a06">&#34;serverLocation&#34;</span>: <span style="color:#4e9a06">&#34;Europe&#34;</span>,
butler-sos    <span style="color:#000;font-weight:bold">|</span>       <span style="color:#4e9a06">&#34;server-type&#34;</span>: <span style="color:#4e9a06">&#34;virtual&#34;</span>,
butler-sos    <span style="color:#000;font-weight:bold">|</span>       <span style="color:#4e9a06">&#34;serverBrand&#34;</span>: <span style="color:#4e9a06">&#34;HP&#34;</span>
butler-sos    <span style="color:#000;font-weight:bold">|</span>     <span style="color:#ce5c00;font-weight:bold">}</span>
butler-sos    <span style="color:#000;font-weight:bold">|</span>   <span style="color:#ce5c00;font-weight:bold">}</span>
butler-sos    <span style="color:#000;font-weight:bold">|</span> <span style="color:#ce5c00;font-weight:bold">]</span>
butler-sos    <span style="color:#000;font-weight:bold">|</span> <span style="color:#0000cf;font-weight:bold">2019</span>-10-12T20:14:22.028Z info: MAIN: Docker healthcheck server now listening
butler-sos    <span style="color:#000;font-weight:bold">|</span> <span style="color:#0000cf;font-weight:bold">2019</span>-10-12T20:14:22.075Z info: CONFIG: Found InfluxDB database: SenseOps
...
...</code></pre></div>
<p>Once everything everything looks good you can stop the container (ctrl-C), then start it again in daemon mode (i.e. running unattended in the background):</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">proton:butler-sos-docker goran$ docker-compose up -d
Starting butler-sos ... <span style="color:#204a87;font-weight:bold">done</span>
proton:butler-sos-docker goran$</code></pre></div>
<p>Setting the log level to info in the config file will reduce log output.</p>

<p>The Docker container implements Docker healthchecks, which means you can run <code>docker ps</code> to see whether the container is healthy or not:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">➜ docker ps
CONTAINER ID        IMAGE                           COMMAND                  CREATED             STATUS                    PORTS               NAMES
905f21443f97        ptarmiganlabs/butler-sos:5.0.0   <span style="color:#4e9a06">&#34;docker-entrypoint.s…&#34;</span>   <span style="color:#0000cf;font-weight:bold">6</span> minutes ago       Up <span style="color:#0000cf;font-weight:bold">22</span> seconds <span style="color:#ce5c00;font-weight:bold">(</span>healthy<span style="color:#ce5c00;font-weight:bold">)</span>                       butler-sos</code></pre></div>
        <div class="section-index">
    
    
    
    
    <hr class="panel-line">
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
    
</div>

	
		<style>
  .feedback--answer {
    display: inline-block;
  }
  .feedback--answer-no {
    margin-left: 1em;
  }
  .feedback--response {
    display: none;
    margin-top: 1em;
  }
  .feedback--response__visible {
    display: block;
  }
</style>
<h2 class="feedback--title">Feedback</h2>
<p class="feedback--question">Was this page helpful?</p>
<button class="feedback--answer feedback--answer-yes">Yes</button>
<button class="feedback--answer feedback--answer-no">No</button>
<p class="feedback--response feedback--response-yes">
  Glad to hear it! Please <a href="https://github.com/ptarmiganlabs/butler-sos/issues/new">tell us how we can improve</a>.
</p>
<p class="feedback--response feedback--response-no">
  Sorry to hear that. Please <a href="https://github.com/ptarmiganlabs/butler-sos/issues/new">tell us how Butler SOS can be improved</a>.
</p>
<script>
  const yesButton = document.querySelector('.feedback--answer-yes');
  const noButton = document.querySelector('.feedback--answer-no');
  const yesResponse = document.querySelector('.feedback--response-yes');
  const noResponse = document.querySelector('.feedback--response-no');
  const disableButtons = () => {
    yesButton.disabled = true;
    noButton.disabled = true;
  };
  const sendFeedback = (value) => {
    if (typeof ga !== 'function') return;
    const args = {
      command: 'send',
      hitType: 'event',
      category: 'Helpful',
      action: 'click',
      label: window.location.pathname,
      value: value
    };
    ga(args.command, args.hitType, args.category, args.action, args.label, args.value);
  };
  yesButton.addEventListener('click', () => {
    yesResponse.classList.add('feedback--response__visible');
    disableButtons();
    sendFeedback(1);
  });
  noButton.addEventListener('click', () => {
    noResponse.classList.add('feedback--response__visible');
    disableButtons();
    sendFeedback(0);
  });
</script>

		<br />
	
	
	<div class="text-muted mt-5 pt-3 border-top">Last modified October 22, 2019: <a  href="https://github.com/ptarmiganlabs/butler-sos-docs/commit/d44ab4081b795bfd47b9dc76a23b8e81304fb78c">Add missing port 4747 in docs (d44ab40)</a>
</div>
</div>

          </main>
        </div>
      </div>
      
<footer class="bg-dark py-5 row d-print-none">
  <div class="container-fluid mx-sm-5">
    <div class="row">
      <div class="col-6 col-sm-4 text-xs-center order-sm-2">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Ptarmigan Labs on Twitter" aria-label="Ptarmigan Labs on Twitter">
    <a class="text-white" target="_blank" href="https://twitter.com/ptarmiganlabs">
      <i class="fab fa-twitter"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="LinkedIn" aria-label="LinkedIn">
    <a class="text-white" target="_blank" href="https://www.linkedin.com/in/gorsan/">
      <i class="fab fa-linkedin"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-6 col-sm-4 text-right text-xs-center order-sm-3">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="GitHub" aria-label="GitHub">
    <a class="text-white" target="_blank" href="https://github.com/ptarmiganlabs/butler-sos">
      <i class="fab fa-github"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Get in touch with Ptarmigan Labs" aria-label="Get in touch with Ptarmigan Labs">
    <a class="text-white" target="_blank" href="mailto://info@ptarmiganlabs.com">
      <i class="fa fa-envelope"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-12 col-sm-4 text-center py-2 order-sm-2">
        <small class="text-white">&copy; 2019 Ptarmigan Labs All Rights Reserved</small>
        
	
		<p class="mt-2"><a href="/about/">About Butler SOS</a></p>
	
      </div>
    </div>
  </div>
</footer>


    </div>
    
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>






<script src="/js/main.min.c7f171fef29a64d827885be471988ee79aad053b01bdf690b7f8ead66e4acc6b.js" integrity="sha256-x/Fx/vKaZNgniFvkcZiO55qtBTsBvfaQt/jq1m5KzGs=" crossorigin="anonymous"></script>



  </body>
</html>